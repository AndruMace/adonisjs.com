{"type":"root","children":[{"type":"element","tag":"dimertitle","props":{},"children":[{"type":"text","value":"December Release (2020)"}]},{"type":"element","tag":"h1","props":{"id":"december-release-2020"},"children":[{"type":"element","tag":"a","props":{"href":"#december-release-2020","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"December Release (2020)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This release has been mainly focused on fixing bugs and making subtle improvements to the existing packages and API."}]},{"type":"element","tag":"div","props":{"className":["toc-container"]},"children":[{"type":"element","tag":"h2","props":{},"children":[{"type":"text","value":"Table of contents"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#highlights"},"children":[{"type":"text","value":"Highlights"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#upgrading-dependencies"},"children":[{"type":"text","value":"Upgrading dependencies"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#auth-tokens-redis-provider"},"children":[{"type":"text","value":"Auth tokens Redis provider"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#mailer-classes"},"children":[{"type":"text","value":"Mailer classes"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#new-syntax-for-edge-components"},"children":[{"type":"text","value":"New syntax for Edge components"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#other-improvements"},"children":[{"type":"text","value":"Other improvements"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#bug-fixes"},"children":[{"type":"text","value":"Bug fixes"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"highlights"},"children":[{"type":"element","tag":"a","props":{"href":"#highlights","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Highlights"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Add support for "},{"type":"element","tag":"a","props":{"href":"#auth-tokens-redis-provider"},"children":[{"type":"text","value":"redis provider"}]},{"type":"text","value":" for storing API tokens"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Add support for "},{"type":"element","tag":"a","props":{"href":"#mailer-classes"},"children":[{"type":"text","value":"mailer classes"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"A new syntax for "},{"type":"element","tag":"a","props":{"href":"#new-syntax-for-edge-components"},"children":[{"type":"text","value":"Edge components"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"A bunch of "},{"type":"element","tag":"a","props":{"href":"#other-improvements"},"children":[{"type":"text","value":"small additions"}]},{"type":"text","value":", along with some "},{"type":"element","tag":"a","props":{"href":"#bug-fixes"},"children":[{"type":"text","value":"bug fixes"}]}]}]},{"type":"element","tag":"h2","props":{"id":"upgrading-dependencies"},"children":[{"type":"element","tag":"a","props":{"href":"#upgrading-dependencies","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Upgrading dependencies"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Make sure you update all the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@adonisjs/*"}]},{"type":"text","value":" packages to their latest alpha releases. For example:"}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-sh","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token function\">npm</span> i @adonisjs/core@alpha @adonisjs/lucid@alpha <span class=\"token operator\">&lt;</span>other-packages<span class=\"token operator\">></span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are no breaking changes in this release, so expect everything to work smoothly."}]},{"type":"element","tag":"h2","props":{"id":"auth-tokens-redis-provider"},"children":[{"type":"element","tag":"a","props":{"href":"#auth-tokens-redis-provider","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Auth tokens Redis provider"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We have added another provider for storing "},{"type":"element","tag":"a","props":{"href":"/guides/auth/api-guard#where-tokens-are-saved"},"children":[{"type":"text","value":"api tokens"}]},{"type":"text","value":" to Redis. This is how we expect you to choose between the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"database"}]},{"type":"text","value":" and the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"redis"}]},{"type":"text","value":" provider."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Use the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"database"}]},{"type":"text","value":" provider, when the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"api tokens"}]},{"type":"text","value":" are the secondary way of authenticating users. For example, You let the users of your app generate personal access tokens that they can use as an alternative to authenticate."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Usually, the personal access tokens are long-lived and are not generated in bulk in a short time and hence SQL database storage is perfect for them."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Use the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"redis"}]},{"type":"text","value":" provider, when the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"api tokens"}]},{"type":"text","value":" are the primary way of authenticating users. For example, You are generating them to authenticate the users of your mobile app or a SPA."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this scenario, tokens are generated in bulk and will be expired after some duration. Redis is a perfect storage option here since it auto cleans the expired key-value pairs"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The configuration for the tokens is defined within the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"config/auth"}]},{"type":"text","value":" file."}]},{"type":"element","tag":"div","props":{"className":["tabs"]},"children":[{"type":"element","tag":"div","props":{"className":["tab-head"]},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{"dataTitle":"tab-1"},"children":[{"type":"text","value":"Database provider"}]},{"type":"element","tag":"li","props":{"dataTitle":"tab-2"},"children":[{"type":"text","value":"Redis provider"}]}]}]},{"type":"element","tag":"div","props":{"className":["tab-body"]},"children":[{"type":"element","tag":"div","props":{"className":["tab-item"],"id":"tab-1"},"children":[{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"Database provider"}]},{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token punctuation\">{</span>\n  tokenProvider<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    driver<span class=\"token operator\">:</span> <span class=\"token string\">'database'</span><span class=\"token punctuation\">,</span>\n    table<span class=\"token operator\">:</span> <span class=\"token string\">'api_tokens'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]}]},{"type":"element","tag":"div","props":{"className":["tab-item"],"id":"tab-2"},"children":[{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"Redis provider"}]},{"type":"element","tag":"pre","props":{"className":["language-ts","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token punctuation\">{</span>\n  tokenProvider<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    driver<span class=\"token operator\">:</span> <span class=\"token string\">'redis'</span><span class=\"token punctuation\">,</span>\n    connection<span class=\"token operator\">:</span> <span class=\"token string\">'local'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When using the Redis driver, you have to define the connection inside the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"config/redis"}]},{"type":"text","value":" file and reference the connection name from the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"tokenProvider.connection"}]},{"type":"text","value":" property."}]},{"type":"element","tag":"h2","props":{"id":"mailer-classes"},"children":[{"type":"element","tag":"a","props":{"href":"#mailer-classes","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Mailer classes"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can now configure/send emails by defining them inside a dedicated mailer class. This will clean up your controllers as you can remove all the inline "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"Mail.send"}]},{"type":"text","value":" calls. Also, the self-contained mailer classes are easier to unit test."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Begin by upgrading the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@adonisjs/mail"}]},{"type":"text","value":" package."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-sh","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token function\">npm</span> i @adonisjs/mail@alpha\n"}]}]}]},{"type":"element","tag":"div","props":{"className":["alert","alert-note"]},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The following steps are only required when upgrading an existing application. For new applications, the command will be added automatically on the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"node ace invoke"}]},{"type":"text","value":" call."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Next, open the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":".adonisrc.json"}]},{"type":"text","value":" file and register the mail package to the array of commands."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-json","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"commands\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token string\">\"@adonisjs/mail/build/commands\"</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finally, run the following ace command to generate a manifest file of all the commands available in your app."}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-sh","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"node ace generate:manifest\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"After this, you can create mailer classes by running the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"node ace make:mailer"}]},{"type":"text","value":" command. Also make sure to read the "},{"type":"element","tag":"a","props":{"href":"/guides/mail#mailer-classes"},"children":[{"type":"text","value":"docs"}]},{"type":"text","value":" as well."}]},{"type":"element","tag":"h2","props":{"id":"new-syntax-for-edge-components"},"children":[{"type":"element","tag":"a","props":{"href":"#new-syntax-for-edge-components","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"New syntax for Edge components"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"With the latest release of the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@adonisjs/view"}]},{"type":"text","value":" package, we will recursively scan the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"resources/views/components"}]},{"type":"text","value":" directory for "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":".edge"}]},{"type":"text","value":" templates and make them available as tags. For example:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Instead of writing the following"}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-edge","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token tag\"><span class=\"token function\">@component</span>(<span class=\"token string\"><span class=\"token punctuation\">'</span>components/modal<span class=\"token punctuation\">'</span></span>, { title: <span class=\"token string\"><span class=\"token punctuation\">'</span>Want to continue?<span class=\"token punctuation\">'</span></span> })</span><span class=\"token tag\"><span class=\"token function\">\n@endcomponent</span></span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can now write"}]},{"type":"element","tag":"div","props":{"className":["dimer-highlight"]},"children":[{"type":"element","tag":"pre","props":{"className":["language-edge","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"<span class=\"token tag\"><span class=\"token function\">@modal</span>({ title: <span class=\"token string\"><span class=\"token punctuation\">'</span>Want to continue?<span class=\"token punctuation\">'</span></span> })</span><span class=\"token tag\"><span class=\"token function\">\n@end</span></span>\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this approach, the file name becomes the tag name. The filenames using "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"_"}]},{"type":"text","value":" or "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" will be converted to "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"camelCase"}]},{"type":"text","value":"."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"components/form-input.edge"}]},{"type":"text","value":" becomes "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@formInput()"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"components/user_avatar.edge"}]},{"type":"text","value":" becomes "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@userAvatar()"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The components inside nested directories are accessible using the dot "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"."}]},{"type":"text","value":" separator."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"components/form/input.edge"}]},{"type":"text","value":" becomes "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"@form.input()"}]}]}]},{"type":"element","tag":"h2","props":{"id":"other-improvements"},"children":[{"type":"element","tag":"a","props":{"href":"#other-improvements","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Other improvements"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Add "},{"type":"element","tag":"a","props":{"href":"/guides/validator/rules#rulesurl"},"children":[{"type":"text","value":"url validation rule"}]},{"type":"text","value":" to the validator."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Add "},{"type":"element","tag":"a","props":{"href":"/guides/model-relations/has-many#updateorcreatemany"},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"updateOrCreateMany"}]}]},{"type":"text","value":" method to the has many relationship."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Add support for "},{"type":"element","tag":"a","props":{"href":"/guides/models/serializing-models#serializing-extras"},"children":[{"type":"text","value":"serializing"}]},{"type":"text","value":" the model "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"$extras"}]},{"type":"text","value":" object."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Crash process on "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"uncaughtException"}]},{"type":"text","value":" exception. As per "},{"type":"element","tag":"a","props":{"href":"https://nodejs.org/api/process.html#process_warning_using_uncaughtexception_correctly"},"children":[{"type":"text","value":"Node.js"}]},{"type":"text","value":" "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"\"It is not safe to resume normal operation after 'uncaughtException'\""}]},{"type":"text","value":" and hence AdonisJS now listens for this event and calls the "},{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"process.exit"}]},{"type":"text","value":" method."}]}]},{"type":"element","tag":"h2","props":{"id":"bug-fixes"},"children":[{"type":"element","tag":"a","props":{"href":"#bug-fixes","aria-hidden":true},"children":[{"type":"element","tag":"span","props":{"className":["icon","icon-link"]},"children":[]}]},{"type":"text","value":"Bug fixes"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"fix: convert milliseconds to seconds when passing to Redis. "},{"type":"element","tag":"a","props":{"href":"https://github.com/adonisjs/session/commit/501cc8d0781c584c435fa463f11128044d7cad8b"},"children":[{"type":"text","value":"501cc8d078"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"fix: ignore body when status code is 304. "},{"type":"element","tag":"a","props":{"href":"https://github.com/adonisjs/http-server/commit/e2dac2060704e68fbfb277321142b05e33919f05"},"children":[{"type":"text","value":"e2dac2060"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"fix: set correct exit code for the commands. "},{"type":"element","tag":"a","props":{"href":"https://github.com/adonisjs/lucid/commit/0047d5b728a1e6e73cc6b575fb4289ab4cfee26f"},"children":[{"type":"text","value":"0047d5b72"}]},{"type":"text","value":". Fixes "},{"type":"element","tag":"a","props":{"href":"https://github.com/adonisjs/ace/issues/119"},"children":[{"type":"text","value":"#119"}]},{"type":"text","value":"."}]}]}]}
