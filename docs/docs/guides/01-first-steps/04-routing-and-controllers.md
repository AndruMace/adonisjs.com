---
permalink: guides/first-steps/routing-and-controllers
category: First Steps
---

# Routing & Controllers

Now that you have completed the initial setup and able to run the development server, let's take a step further and begin the development of our blog.

Don't get overwhelmed with the number of files and directories generated by `npx create-adonis-ts-app` command. For now, just focus on the files and directories needed for this tutorial.

- The `app` directory holds the main source code of your application. The **Controllers** and **Models** will be created inside this directory.
- The `start` directory contains the files that must be loaded only once during the boot process. The file to declare routes is also inside this directory.
- The `resources/views` directory contains the templates for rendering HTML.
- The `public` directory is to store the public assets like **CSS files**, **frontend Javascript** or **images**.

## Routing

Routing is a way of exposing the URL's of your website to the outer world. For example: If you want your website to have `/contact`, `/about` URL's, you must begin by registering routes for them.

In AdonisJS, the routes are defined inside `start/routes.ts` file. Let's open this file in your text editor and replace it's contents with the following code snippet.

```ts{}{start/routes.ts}
import Route from '@ioc:Adonis/Core/Route'

/**
 * An array of posts. Later we will fetch them from the
 * database.
 */
const posts = [
  {
    id: '1',
    title: 'Adonis 101',
    description: 'Welcome to AdonisJS!',
  },
  {
    id: '2',
    title: 'Deployments 101',
    description: 'Time to deploy your application!',
  },
]

/**
 * Return all posts
 */
Route.get('/', async () => {
  return posts
})

/**
 * Display a single post using it's id
 */
Route.get('/posts/:id', async ({ params, response }) => {
  const matchingPost = posts.find((post) => post.id === params.id)

  // highlight-start
  if (!matchingPost) {
    return response.status(404).send('Post not found')
  }
  // highlight-end

  return matchingPost
})
```

Make sure to start the development server by running `node ace serve --watch` and then visit the following URL's in your browser.

- [http://localhost:3333](http://localhost:3333)
- [http://localhost:3333/posts/1](http://localhost:3333/posts/1)
- [http://localhost:3333/posts/2](http://localhost:3333/posts/2)
- [http://localhost:3333/posts/3](http://localhost:3333/posts/3) *(Returns 404)*

[video url="https://res.cloudinary.com/adonis-js/video/upload/q_100/v1580185571/adonisjs.com/adonisjs-routing_lgmvef.mp4", controls]

Voila! You have a working application that responds to the routes defined inside the `start/routes.ts` file.

### How Routes Work?

- You begin by importing the `@ioc:Adonis/Core/Route` module at the top of the file.
- The `Route.get` method accepts a total of two arguments. First is the route pattern, followed by the route handler. The route handler can be an inline function (aka closure) or reference to an HTTP controller method.
- The route pattern can be a static URL like `/`, `/contact` or it can accept dynamic parameters like `/posts/:id`. Here `:id` is a called a route parameter.
- The dynamic values of route parameters are passed to the route handler as `params` object.

We also have a [dedicated guide on Routing](/guides/http/routing), but for now, let's focus on creating the blog.

## Controllers
Writing inline route handlers is fine for quickly testing some code. However, as the number of routes will grow, it will become cumbersome to put all the code inside a single file and this is where controllers shines.

Controllers are vanilla [ES6 classes](https://exploringjs.com/es6/ch_classes.html) stored inside the `app/Controllers/Http` directory. The sole purpose of controllers is to handle incoming HTTP requests.

Let's begin by creating a new controller file by running the following command in the terminal.

```shell
node ace make:controller Posts
# âœ”  create    app/Controllers/Http/PostsController.ts
```

Open the newly created file inside your text editor and replace it's content with the following code snippet.

```ts{}{app/Controllers/Http/PostsController.ts}
import { HttpContextContract } from '@ioc:Adonis/Core/HttpContext'

export default class PostsController {
  /**
   * An array of posts. Later we will fetch them from the
   * database.
   */
  private posts = [
    {
      id: '1',
      title: 'Adonis 101',
      description: 'Welcome to AdonisJS!',
    },
    {
      id: '2',
      title: 'Deployments 101',
      description: 'Time to deploy your application!',
    },
  ]

  /**
   * Return all posts
   */
  public async index () {
    return this.posts
  }

  /**
   * Display a single post using it's id
   */
  public async show ({ params, response }: HttpContextContract) {
    const matchingPost = this.posts.find((post) => post.id === params.id)

    // highlight-start
    if (!matchingPost) {
      return response.status(404).send('Post not found')
    }
    // highlight-end

    return matchingPost
  }
}
```

Now, that we have moved all the logic to a dedicated controller class, let's cleanup the routes file by replacing inline route handlers with the controller methods.

```ts{}{start/routes.ts}
import Route from '@ioc:Adonis/Core/Route'

Route.get('/', 'PostsController.index')
Route.get('/posts/:id', 'PostsController.show')
```

If you visit the same URL's again, you will see same output as earlier. But this time we have a cleaner routes file and all the logic lives inside a controller class.

### How Controller Work?

- Controllers are plain Javascript classes with methods to handle the request for a given route. Make sure to always have `export default` in the controller files.
- For every request, AdonisJS will create a new instance of the controller class designated to handle that request.
- Instead of importing controllers directly inside the routes file, you pass a reference to the `controller.method` as a string. This allows AdonisJS to lazy load the controllers instead of loading them together at once.
